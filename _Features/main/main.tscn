[gd_scene load_steps=47 format=3 uid="uid://b3hl0t3spppnd"]

[ext_resource type="Script" path="res://_Features/foundation/scene_director.gd" id="1_6gnox"]
[ext_resource type="Script" path="res://_Features/audio/audio.gd" id="2_3jmlc"]
[ext_resource type="PackedScene" uid="uid://ccopiuj5gnm7m" path="res://_Features/UI/ui.tscn" id="2_7rttm"]
[ext_resource type="PackedScene" uid="uid://dpkgwkvewfmuh" path="res://_Features/player/player.tscn" id="2_bfl1y"]
[ext_resource type="Script" path="res://addons/phantom_camera/scripts/phantom_camera_host/phantom_camera_host.gd" id="2_hsqid"]
[ext_resource type="Shader" path="res://_Features/shaders/main.gdshader" id="2_o8u0n"]
[ext_resource type="Material" uid="uid://c7ywy5eu6to4" path="res://_Features/common/noise.tres" id="3_bni4b"]
[ext_resource type="Script" path="res://_Features/main/action_controller.gd" id="3_fao63"]
[ext_resource type="AudioStream" uid="uid://cit1i7ncdx4f" path="res://_Features/audio/dream1.mp3" id="3_prhnp"]
[ext_resource type="Script" path="res://_Features/foundation/awake.gd" id="3_uiotc"]
[ext_resource type="PackedScene" uid="uid://daj1yi4q8q4f" path="res://_Features/rooms/living_room/living_room_i.tscn" id="4_og77x"]
[ext_resource type="AudioStream" uid="uid://cuk1tniwd3pdb" path="res://_Features/audio/Discord Call.mp3" id="5_22t2j"]
[ext_resource type="PackedScene" uid="uid://21y5whkdu8f2" path="res://_Features/activables/spawney/pera!.tscn" id="5_c1mtb"]
[ext_resource type="AudioStream" uid="uid://c2gih22b1rxfb" path="res://_Features/audio/dream2.mp3" id="5_eo21i"]
[ext_resource type="Script" path="res://_Features/UI/pause.gd" id="5_xm3o3"]
[ext_resource type="AudioStream" uid="uid://jval2fa4776l" path="res://_Features/audio/dream3.mp3" id="6_3nhco"]
[ext_resource type="AudioStream" uid="uid://bn2dwbajil1as" path="res://_Features/audio/dream5.mp3" id="7_3aj0d"]
[ext_resource type="AudioStream" uid="uid://bv1q0nrtlprpr" path="res://_Features/audio/dream4.mp3" id="8_fiqc0"]
[ext_resource type="AudioStream" uid="uid://n5q1vmi85jkl" path="res://_Features/audio/dream7.mp3" id="8_g4ua3"]
[ext_resource type="Script" path="res://_Features/rooms/moor_moor_gnivil/moor_gnivil.gd" id="8_ku7b2"]
[ext_resource type="AudioStream" uid="uid://dx7cph4eee7ok" path="res://_Features/audio/dream9.mp3" id="9_8pkpd"]
[ext_resource type="PackedScene" uid="uid://cb0311e3f7has" path="res://_Features/rooms/moor_moor_gnivil/moor_gnivil_i.tscn" id="9_iwvg8"]
[ext_resource type="AudioStream" uid="uid://cwe5fggyyhwa7" path="res://_Features/audio/dream6.mp3" id="10_gllsq"]
[ext_resource type="AudioStream" uid="uid://byd5j83axjxbg" path="res://_Features/audio/dream11.mp3" id="10_pl0ge"]
[ext_resource type="PackedScene" uid="uid://c0bdwlue70wgp" path="res://_Features/rooms/setup/setup_i.tscn" id="11_qjeg8"]
[ext_resource type="AudioStream" uid="uid://m7oax2by6piw" path="res://_Features/audio/dream12.mp3" id="11_r4hg3"]
[ext_resource type="AudioStream" uid="uid://drmnieapiewxo" path="res://_Features/audio/despierta.mp3" id="12_bx7a7"]
[ext_resource type="AudioStream" uid="uid://b4x4go7yxbinu" path="res://_Features/audio/dream13.mp3" id="12_nchqr"]
[ext_resource type="Script" path="res://addons/phantom_camera/scripts/phantom_camera/phantom_camera_3D.gd" id="28_p26eg"]
[ext_resource type="Script" path="res://addons/phantom_camera/scripts/resources/tween_resource.gd" id="29_sua37"]
[ext_resource type="Script" path="res://addons/phantom_camera/scripts/resources/camera_3d_resource.gd" id="30_cxxuw"]

[sub_resource type="Gradient" id="Gradient_n7fhn"]
colors = PackedColorArray(0, 0, 0, 1, 1, 0, 0, 1)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_gteco"]
gradient = SubResource("Gradient_n7fhn")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_yhrax"]
shader = ExtResource("2_o8u0n")
shader_parameter/overall_effect = 0.2
shader_parameter/pallete_effect = 0.2
shader_parameter/overall_brightness = -3.0
shader_parameter/scan_brightness = 1.0
shader_parameter/pallette_brightness = 1.0
shader_parameter/overlay = true
shader_parameter/scanlines_opacity = 0.559
shader_parameter/scanlines_width = 0.335
shader_parameter/grille_opacity = 0.181
shader_parameter/resolution = Vector2(640, 480)
shader_parameter/pixelate = false
shader_parameter/roll = true
shader_parameter/roll_speed = 0.2
shader_parameter/roll_size = 0.2
shader_parameter/roll_variation = 5.0
shader_parameter/distort_intensity = 0.017
shader_parameter/noise_opacity = 0.02
shader_parameter/noise_speed = 3.05
shader_parameter/static_noise_intensity = 0.091
shader_parameter/aberration = 4.75e-08
shader_parameter/discolor = true
shader_parameter/warp_amount = 0.006
shader_parameter/clip_warp = false
shader_parameter/vignette_intensity = 0.585
shader_parameter/vignette_opacity = 0.141
shader_parameter/pixel = 1.0
shader_parameter/pallete = SubResource("GradientTexture2D_gteco")

[sub_resource type="Resource" id="Resource_dqitb"]
script = ExtResource("29_sua37")
duration = 1.0
transition = 0
ease = 2

[sub_resource type="Resource" id="Resource_31gcf"]
script = ExtResource("30_cxxuw")
cull_mask = 1048575
h_offset = 0.0
v_offset = 0.0
fov = 75.0

[sub_resource type="Environment" id="Environment_gtx4b"]
background_mode = 1
background_color = Color(0.2, 0.2, 0.2, 1)
tonemap_mode = 2
tonemap_white = 16.0
ssr_fade_in = 6.11788
ssr_fade_out = 3.73213
ssr_depth_tolerance = 24.11
ssao_enabled = true
ssao_intensity = 3.35
ssao_detail = 0.92
ssao_sharpness = 0.27
ssil_enabled = true
ssil_radius = 0.81
ssil_intensity = 1.45
sdfgi_enabled = true
sdfgi_use_occlusion = true
sdfgi_min_cell_size = 0.798145
sdfgi_energy = 0.17
sdfgi_normal_bias = 0.06
sdfgi_probe_bias = 0.03
glow_enabled = true
glow_strength = 1.28
glow_bloom = 0.01
fog_enabled = true
fog_light_color = Color(0, 0, 0, 1)
fog_light_energy = 0.32
fog_density = 0.0125
volumetric_fog_albedo = Color(0.2, 0.2, 0.2, 1)
volumetric_fog_emission = Color(0.2, 0.2, 0.2, 1)
volumetric_fog_emission_energy = 0.6
volumetric_fog_detail_spread = 0.757858
volumetric_fog_ambient_inject = 6.47

[sub_resource type="NavigationMesh" id="NavigationMesh_ncr5a"]
vertices = PackedVector3Array(-20.4253, 0.12, -4.16918, -20.4253, 0.12, -1.66918, -18.6753, 0.12, -1.66918, -20.4253, 0.12, -4.16918, -18.6753, 0.12, -1.66918, -18.1753, 0.12, -1.16918, -6.92535, 0.12, 3.33082, -4.92535, 0.12, 3.33082, -4.92535, 0.12, -4.16918, -18.1753, 0.12, 3.58082, -6.92535, 0.12, 3.58082, -6.92535, 0.12, 3.33082, -18.1753, 0.12, -1.16918)
polygons = [PackedInt32Array(2, 1, 0), PackedInt32Array(4, 3, 5), PackedInt32Array(5, 3, 6), PackedInt32Array(6, 3, 7), PackedInt32Array(7, 3, 8), PackedInt32Array(10, 9, 11), PackedInt32Array(11, 9, 12)]
cell_height = 0.01
agent_radius = 0.25
edge_max_error = 0.77
filter_ledge_spans = true

[sub_resource type="BoxShape3D" id="BoxShape3D_jau8k"]
size = Vector3(17.4316, 2, 0.224121)

[sub_resource type="BoxShape3D" id="BoxShape3D_k34d7"]
size = Vector3(16.1826, 1.3902, 1.10425)

[sub_resource type="BoxShape3D" id="BoxShape3D_i8yqo"]
size = Vector3(0.220024, 3.50208, 13.9919)

[sub_resource type="BoxShape3D" id="BoxShape3D_q6i7a"]
size = Vector3(0.220024, 2, 10.1202)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_jw0lm"]
albedo_color = Color(0, 0, 0, 1)
emission = Color(0.2, 0.2, 0.2, 1)
disable_receive_shadows = true

[sub_resource type="PlaneMesh" id="PlaneMesh_a8ryy"]
material = SubResource("StandardMaterial3D_jw0lm")
size = Vector2(10.605, 10.59)

[sub_resource type="PlaneMesh" id="PlaneMesh_u5dyn"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_s78er"]
transparency = 1
albedo_color = Color(0, 0.486275, 0.490196, 0.509804)
metallic = 1.0
metallic_specular = 0.49
roughness = 0.28
emission_enabled = true
emission = Color(0.909804, 1, 1, 1)
emission_energy_multiplier = 0.11
refraction_scale = 0.21

[node name="Main" type="Node3D"]
script = ExtResource("1_6gnox")
pera = ExtResource("5_c1mtb")
discord_call = ExtResource("5_22t2j")
noise_material = ExtResource("3_bni4b")

[node name="Awake" type="Node" parent="." node_paths=PackedStringArray("world_environment")]
script = ExtResource("3_uiotc")
world_environment = NodePath("../WorldEnvironment")

[node name="ActionController" type="Node" parent="."]
script = ExtResource("3_fao63")

[node name="Scan" type="ColorRect" parent="."]
material = SubResource("ShaderMaterial_yhrax")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2
color = Color(1, 1, 1, 0)

[node name="UI" parent="." instance=ExtResource("2_7rttm")]
mouse_filter = 2

[node name="Pause" type="Control" parent="."]
visible = false
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
size_flags_horizontal = 3
size_flags_vertical = 3
mouse_filter = 2
script = ExtResource("5_xm3o3")

[node name="MarginContainer" type="MarginContainer" parent="Pause"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme_override_constants/margin_left = 100
theme_override_constants/margin_top = 100
theme_override_constants/margin_right = 100
theme_override_constants/margin_bottom = 100

[node name="Panel" type="Panel" parent="Pause/MarginContainer"]
layout_mode = 2

[node name="MarginContainer" type="MarginContainer" parent="Pause/MarginContainer/Panel"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme_override_constants/margin_left = 50
theme_override_constants/margin_right = 50

[node name="VBoxContainer" type="VBoxContainer" parent="Pause/MarginContainer/Panel/MarginContainer"]
layout_mode = 2
theme_override_constants/separation = 30
alignment = 1

[node name="Musicbel" type="Label" parent="Pause/MarginContainer/Panel/MarginContainer/VBoxContainer"]
layout_mode = 2
text = "MENU_MUSIC"

[node name="Music" type="HSlider" parent="Pause/MarginContainer/Panel/MarginContainer/VBoxContainer"]
unique_name_in_owner = true
layout_mode = 2
value = 100.0

[node name="DialogLabel" type="Label" parent="Pause/MarginContainer/Panel/MarginContainer/VBoxContainer"]
layout_mode = 2
text = "MENU_DIALOGS"

[node name="Dialogs" type="HSlider" parent="Pause/MarginContainer/Panel/MarginContainer/VBoxContainer"]
unique_name_in_owner = true
layout_mode = 2
value = 100.0

[node name="SFXLabel" type="Label" parent="Pause/MarginContainer/Panel/MarginContainer/VBoxContainer"]
layout_mode = 2
text = "MENU_SFX"

[node name="SFX" type="HSlider" parent="Pause/MarginContainer/Panel/MarginContainer/VBoxContainer"]
unique_name_in_owner = true
layout_mode = 2
value = 100.0

[node name="Button" type="Button" parent="Pause/MarginContainer/Panel/MarginContainer/VBoxContainer"]
layout_mode = 2
size_flags_horizontal = 4
size_flags_vertical = 4
text = "MENU_EXIT"

[node name="Audio" type="Node" parent="."]
script = ExtResource("2_3jmlc")
song_layers = Array[AudioStream]([ExtResource("3_prhnp"), ExtResource("5_eo21i"), ExtResource("6_3nhco"), ExtResource("8_fiqc0"), ExtResource("7_3aj0d"), ExtResource("10_gllsq"), ExtResource("8_g4ua3"), ExtResource("9_8pkpd"), ExtResource("10_pl0ge"), ExtResource("11_r4hg3"), ExtResource("12_nchqr")])

[node name="MainMusic" type="AudioStreamPlayer" parent="Audio"]
bus = &"Music"

[node name="Plas" type="AudioStreamPlayer" parent="Audio"]
stream = ExtResource("12_bx7a7")
bus = &"Dialogs"

[node name="CameraGroup" type="Node" parent="."]

[node name="PhantomCamera3D" type="Node3D" parent="CameraGroup" node_paths=PackedStringArray("follow_target")]
transform = Transform3D(0.999997, 0, 0, 0, -4.3711e-08, 0.999996, 0, -0.999992, -4.37112e-08, -20.9567, 9, 1.18784)
script = ExtResource("28_p26eg")
follow_mode = 2
follow_target = NodePath("../../Player")
tween_resource = SubResource("Resource_dqitb")
tween_on_load = false
camera_3d_resource = SubResource("Resource_31gcf")
follow_offset = Vector3(0, 9, 0)
follow_damping = true
follow_damping_value = Vector3(0.1, 0, 0.1)

[node name="Camera3D" type="Camera3D" parent="CameraGroup"]
transform = Transform3D(0.999997, 0, 0, 0, -4.3711e-08, 0.999996, 0, -0.999992, -4.37112e-08, -20.9567, 9, 1.18784)
current = true

[node name="PhantomCameraHost" type="Node" parent="CameraGroup/Camera3D"]
script = ExtResource("2_hsqid")

[node name="Player" parent="." instance=ExtResource("2_bfl1y")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -20.9567, -1.90735e-06, 1.18784)

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_gtx4b")

[node name="NavigationRegion3D" type="NavigationRegion3D" parent="."]
navigation_mesh = SubResource("NavigationMesh_ncr5a")

[node name="CSGPolygon3D" type="CSGPolygon3D" parent="NavigationRegion3D"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, -1, 0, 1, -4.37114e-08, 0, 0, 0)
visible = false
polygon = PackedVector2Array(-20.9253, -4.66918, -4.56809, -4.66918, -4.54451, 3.79228, -18.6627, 4.00441, -18.6627, -1.41658, -20.9253, -1.36945)
depth = 0.1

[node name="Stage" type="Node" parent="."]

[node name="StaticBody3D" type="StaticBody3D" parent="Stage"]
collision_layer = 4
input_ray_pickable = false

[node name="externalWall" type="CollisionShape3D" parent="Stage/StaticBody3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -12.7349, 0.5, -5.08222)
shape = SubResource("BoxShape3D_jau8k")

[node name="externalWall2" type="CollisionShape3D" parent="Stage/StaticBody3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -12.161, 0.1951, 4.65441)
shape = SubResource("BoxShape3D_k34d7")

[node name="externalWall3" type="CollisionShape3D" parent="Stage/StaticBody3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4.17967, 1.25104, -0.724903)
shape = SubResource("BoxShape3D_i8yqo")

[node name="externalWall4" type="CollisionShape3D" parent="Stage/StaticBody3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -21.4554, 0.5, -6.03532)
shape = SubResource("BoxShape3D_q6i7a")

[node name="MoorGnivil" type="Node3D" parent="Stage"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -11.6558)
script = ExtResource("8_ku7b2")

[node name="Nolas" parent="Stage/MoorGnivil" instance=ExtResource("9_iwvg8")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1.48041)

[node name="Ceiling" type="MeshInstance3D" parent="Stage/MoorGnivil"]
transform = Transform3D(-4.37114e-08, -1, 0, 1, -4.37114e-08, 0, 0, 0, 1.0305, -4.19549, 3.02274, 1.21847)
cast_shadow = 0
mesh = SubResource("PlaneMesh_a8ryy")
skeleton = NodePath("")

[node name="Ceiling2" type="MeshInstance3D" parent="Stage/MoorGnivil/Ceiling"]
transform = Transform3D(-3.45017e-08, 1, 0, -0.789306, -4.37114e-08, 0, 0, 0, 0.970407, 0.0334408, -4.20017, 0.139951)
cast_shadow = 0
mesh = SubResource("PlaneMesh_a8ryy")
skeleton = NodePath("")

[node name="Setup" type="Node3D" parent="Stage"]
transform = Transform3D(-4.37114e-08, 0, -1, 0, 1, 0, 1, 0, -4.37114e-08, -23.0907, 0, 1.58796)

[node name="setup" parent="Stage/Setup" instance=ExtResource("11_qjeg8")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -3.60012e-05, 0, -0.013937)

[node name="LivingRoom" type="Node3D" parent="Stage"]

[node name="LivingRoom" parent="Stage/LivingRoom" instance=ExtResource("4_og77x")]

[node name="MirrorSalonMesh" type="MeshInstance3D" parent="Stage/LivingRoom/LivingRoom"]
transform = Transform3D(1.23121, 0, 0, 0, -4.37114e-08, -1.37692, 0, 1, -6.01869e-08, 2.3917, 1.381, -5.09583)
mesh = SubResource("PlaneMesh_u5dyn")
surface_material_override/0 = SubResource("StandardMaterial3D_s78er")

[node name="MeshInstance3D2" type="MeshInstance3D" parent="Stage/LivingRoom/LivingRoom"]
transform = Transform3D(1.23121, 0, 0, 0, -4.37114e-08, -1.37692, 0, 1, -6.01869e-08, 2.3917, 1.381, -5.09583)
visible = false
mesh = SubResource("PlaneMesh_u5dyn")
surface_material_override/0 = SubResource("StandardMaterial3D_s78er")

[connection signal="value_changed" from="Pause/MarginContainer/Panel/MarginContainer/VBoxContainer/Music" to="Pause" method="_on_music_value_changed"]
[connection signal="value_changed" from="Pause/MarginContainer/Panel/MarginContainer/VBoxContainer/Dialogs" to="Pause" method="_on_dialogs_value_changed"]
[connection signal="value_changed" from="Pause/MarginContainer/Panel/MarginContainer/VBoxContainer/SFX" to="Pause" method="_on_sfx_value_changed"]
[connection signal="pressed" from="Pause/MarginContainer/Panel/MarginContainer/VBoxContainer/Button" to="." method="_on_button_pressed"]
